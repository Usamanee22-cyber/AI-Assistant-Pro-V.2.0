<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>LANGE MODEL V.160 | GLOBAL MONOLITH</title>
    <script src="https://cdn.tailwindcss.com"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script> <script src="https://unpkg.com/html5-qrcode"></script> <style>
        @import url('https://fonts.googleapis.com/css2?family=Fira+Code&family=Noto+Sans+Thai:wght@400;900&display=swap');
        body { background: #010409; color: #c9d1d9; font-family: 'Noto Sans Thai', sans-serif; margin: 0; overflow: hidden; }
        .glass-panel { background: rgba(13, 17, 23, 0.95); backdrop-filter: blur(20px); border: 1px solid #30363d; border-radius: 24px; }
        .monolith-viewer { font-size: 7px; color: #21262d; line-height: 1.1; }
        .active-token { color: #58a6ff; font-weight: bold; }
        .predict-hint { color: #58a6ff; opacity: 0.5; font-style: italic; }
        .loading-spinner { animation: spin 1.5s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .learning-node { width: 5px; height: 5px; background: #238636; border-radius: 50%; display: inline-block; margin: 1px; }
    </style>
</head>
<body class="h-screen flex flex-col">

<div id="gate" class="fixed inset-0 z-[100] bg-black flex flex-col items-center justify-center p-6">
    <h1 class="text-6xl font-black italic text-blue-500 mb-2">LANGE-V160</h1>
    <p class="text-gray-600 font-mono tracking-[1.5em] text-[10px] mb-12">GLOBAL MONOLITH CORE</p>
    <input type="text" id="adminIn" class="bg-transparent border-b-2 border-blue-900 p-4 text-center text-4xl font-bold outline-none text-white w-full max-w-md mb-8" placeholder="IDENTIFY NAME">
    <button onclick="checkAdmin()" class="bg-blue-600 px-20 py-5 rounded-full font-black text-xl hover:bg-blue-500 shadow-2xl transition-all">CONNECT NEURAL</button>
</div>

<div id="dashboard" class="hidden fixed inset-0 z-[90] bg-black/98 flex flex-col items-center justify-center p-10">
    <h2 class="text-3xl font-black mb-12 text-blue-400 italic">SYSTEM ADMINISTRATOR: TONUS</h2>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 w-full max-w-6xl">
        <div onclick="initMode(1)" class="p-10 rounded-3xl glass-panel border border-blue-500 cursor-pointer hover:bg-[#161b22] transition">
            <div class="text-blue-500 font-black text-2xl mb-2">1. ADMIN TRAINING (QR)</div>
            <p class="text-gray-500 text-xs">Generate Master QR for Device Sync</p>
        </div>
        <div onclick="initMode(2)" class="p-10 rounded-3xl glass-panel border border-green-500 cursor-pointer hover:bg-[#161b22] transition">
            <div class="text-green-500 font-black text-2xl mb-2">2. GRAPH LEARNING CURVE</div>
            <p class="text-gray-600 text-xs">Visualize ML/DL Training Progress</p>
        </div>
        <div onclick="initMode(3)" class="p-10 rounded-3xl glass-panel border border-yellow-500 cursor-pointer hover:bg-[#161b22] transition relative">
            <div class="text-yellow-500 font-black text-2xl mb-2">3. LOCAL STRONG (MONOLITH)</div>
            <p class="text-gray-600 text-xs">Access Hard-Coded Knowledge Base</p>
            <input type="password" id="localPass" onkeyup="verifyLocal(this)" class="absolute top-2 left-2 w-4 bg-transparent border-none text-[2px] outline-none" placeholder=".">
        </div>
    </div>
</div>

<div id="main-system" class="hidden h-full flex flex-col">
    <div id="syncToast" class="hidden fixed top-20 left-1/2 -translate-x-1/2 bg-green-600 text-white px-10 py-4 rounded-full font-black shadow-2xl z-[200]">เชื่อมต่อ</div>
    
    <header class="p-4 border-b border-[#30363d] flex justify-between bg-black/80 items-center">
        <div class="flex items-center gap-4">
            <span class="text-blue-500 font-black italic">LANGE-MODEL-V160</span>
            <span id="connStatus" class="text-[9px] font-mono text-gray-600">STANDALONE_EDGE</span>
        </div>
        <div class="flex items-center gap-2">
            <div id="astral-spinner" class="hidden text-white loading-spinner">⭐</div> 
            <span class="text-[10px] text-gray-500 font-mono">LLM_CORE_ACTIVE</span>
        </div>
    </header>

    <div class="flex-1 flex overflow-hidden">
        <section class="flex-1 flex flex-col border-r border-[#30363d]">
            <div id="chat-view" class="flex-1 overflow-y-auto p-8 space-y-6"></div>
            
            <div id="prediction-area" class="px-8 py-2 h-6 text-sm predict-hint"></div>

            <div class="h-44 bg-black/90 p-4 border-t border-[#30363d] font-mono text-[9px] overflow-y-auto">
                <div class="text-blue-400 font-bold mb-2 underline">>> LLM_VECTOR_SPACE_ANALYSIS (TRAINING)</div>
                <div id="neuralTrace"></div>
                <div id="graph-curve" class="mt-2 h-8 border border-gray-800 flex items-end"></div>
            </div>

            <form onsubmit="runInference(event)" class="p-6 bg-[#0d1117] flex gap-4">
                <input type="text" id="userInput" oninput="predictNextWord(this.value)" class="flex-1 bg-black border border-[#30363d] p-5 rounded-3xl outline-none focus:border-blue-500 text-white text-lg shadow-inner" placeholder="Enter input for Global LLM..." autocomplete="off">
                <button class="bg-blue-600 px-12 rounded-3xl font-black shadow-[0_0_20px_rgba(37,99,235,0.3)] hover:bg-blue-500 transition">PROCESS</button>
            </form>
        </section>

        <aside id="monolithUI" class="hidden w-2/5 p-6 bg-black overflow-y-auto">
            <h3 class="text-xs font-black text-gray-700 mb-4 tracking-widest">MONOLITH_5000_WORDS_CORE</h3>
            <div id="wordGrid" class="monolith-viewer"></div>
        </aside>
    </div>
</div>

<div id="overlayUI" class="hidden fixed inset-0 z-[110] bg-black/95 flex flex-col items-center justify-center p-10">
    <div id="qrContainer" class="bg-white p-6 rounded-3xl hidden"></div>
    <div id="scannerContainer" class="w-full max-w-sm hidden">
        <div id="reader" class="rounded-3xl overflow-hidden border-4 border-blue-600"></div>
    </div>
    <button onclick="closeOverlay()" class="mt-10 text-gray-500 underline font-bold">BACK TO DASHBOARD</button>
</div>

<script>
// --- [ HARD-CODED MONOLITH: 5,000+ WORDS ] ---
// คุณโตนัสสามารถก๊อปปี้คำศัพท์ทั้งหมดมาวางต่อใน Array นี้ได้เลย ห้ามใช้ Loop
const DATA_CORE = [
    "สังคม", "ประชาชน", "กฎหมาย", "รัฐมนตรี", "นโยบาย", "งบประมาณ", "เลือกตั้ง", "สิทธิ", "หน้าที่", "การศึกษา", "วิทยาศาสตร์", "เทคโนโลยี", "คอมพิวเตอร์", "ปัญญาประดิษฐ์", "อัลกอริทึม", "โปรแกรม", "ข้อมูล", "บิ๊กดาต้า", "การเรียนรู้", "แมชชีนเลิร์นนิง", "ดีปเลิร์นนิง", "โครงข่ายประสาท", "สถาปัตยกรรม", "วิศวกรรม", "นวัตกรรม", "อนาคต", "การเปลี่ยนแปลง", "วัฒนธรรม", "ประเพณี", "ประวัติศาสตร์", "ภูมิศาสตร์", "ทรัพยากร", "สิ่งแวดล้อม", "พลังงาน", "ไฟฟ้า", "อวกาศ", "จักรวาล", "โลก", "มนุษย์", "ชีวิต", "สุขภาพ", "การแพทย์", "เศรษฐกิจ", "การค้า", "กำไร", "ขาดทุน", "ธนาคาร", "การเงิน", "หุ้น", "การลงทุน", "ธุรกิจ", "จัดการ", "ลูกค้า", "แบรนด์", "การตลาด", "ความสำเร็จ", "ความล้มเหลว", "ความพยายาม", "ความอดทน", "ความฉลาด", "ความรู้", "ทักษะ", "ประสบการณ์", "สากล", "มาตรฐาน", "ถูกต้อง", "แม่นยำ", "รวดเร็ว", "ประสิทธิภาพ", "ความเร็ว", "ความหน่วง", "เซิร์ฟเวอร์", "คลาวด์", "เครือข่าย", "ความปลอดภัย", "การเข้ารหัส", "ถอดรหัส", "รหัสผ่าน", "สแกน", "คิวอาร์", "ไอแพด", "แท็บเล็ต", "มือถือ", "สมาร์ท", "ระบบ", "อัตโนมัติ", "หุ่นยนต์", "โดรน", "เสมือนจริง", "ดิจิทัล", "อนาล็อก", "สัญญาณ", "ดาวเทียม", "นำทาง", "จีพีเอส", "วินโดวส์", "แอนดรอยด์", "ไอโอเอส", "ซอฟต์แวร์", "ฮาร์ดแวร์", "ซีพียู", "การ์ดจอ", "แรม", "หน่วยความจำ", "สมการ", "ยกกำลัง", "รากที่สอง", "พื้นที่", "ปริมาตร", "กว้าง", "ยาว", "สูง", "ลึก", "รัศมี", "พีชคณิต", "สถิติ", "บวก", "ลบ", "คูณ", "หาร", "ฟิสิกส์", "เคมี", "ชีววิทยา", "อะตอม", "โมเลกุล", "ธาตุ", "ออกซิเจน", "ไฮโดรเจน", "คาร์บอน", "ไนโตรเจน", "แรงโน้มถ่วง", "แม่เหล็ก", "ความร้อน", "อุณหภูมิ", "แสง", "เสียง", "แรง", "ความดัน", "เซลล์", "ดีเอ็นเอ", "พันธุกรรม", "วิวัฒนาการ", "ระบบนิเวศ", "สังเคราะห์แสง", "แบคทีเรีย", "ไวรัส", "กล้องจุลทรรศน์", "โทรทรรศน์", "จักรวาล", "ดาราศาสตร์", "ดาวฤกษ์", "ดาวเคราะห์", "หลุมดำ", "มิติ", "เวลา", "สัมพัทธภาพ", "ควอนตัม", "สัญญาณ", "พิกัด", "จำลอง", "ปัญญา", "วิสัยทัศน์", "กลยุทธ์", "มาตรฐาน", "ทันสมัย", "ความก้าวหน้า", "ความยั่งยืน", "สิ่งแวดล้อม", "มลพิษ", "โลกร้อน", "ธรรมชาติ", "แหล่งน้ำ", "อากาศ", "ความหวัง", "ความฝัน", "เป้าหมาย", "ความสำเร็จ", "ความล้มเหลว", "การเรียนรู้", "บริษัท", "สตาร์ทอัพ", "อุตสาหกรรม", "การผลิต", "ลูกค้า", "แบรนด์", "สัญญา", "ข้อตกลง", "กฎระเบียบ", "มาตรฐานสากล", "เย่", "ไหม", "สวัสดี", "ขอบคุณ", "ขอโทษ", "ยินดี", "ลาก่อน", "แน่นอน", "วิเศษ", "ยอดเยี่ยม", "ถูกต้อง", "เข้าใจ", "อธิบาย", "ความจริง", "ปัญหา", "แก้ไข", "พัฒนา", "เติบโต", "แข็งแรง", "รวดเร็ว", "แม่นยำ", "คุย", "อะไร", "กัน", "ดี", "อ่ะ", "น้า", "ครับ", "ค่ะ", "จร้า", "จ๊ะ", "มั้ย", "เพลา", "กาล", "ภพ", "ชาติ", "คน", "รัก", "บ้าน", "เมือง", "น้ำใจ", "สัจจะ", "บุญ", "กรรม", "สมาธิ", "สติ", "ปัญญา", "สว่าง", "สงบ", "เย็น", "ร้อน", "หนาว", "สูง", "ต่ำ", "ดำ", "ขาว", "จริง", "เท็จ"
    // (รายการคำศัพท์เพิ่มจนครบ 5,000 - 10,000 คำ สามารถนำมาวางที่นี่ได้โดยตรง)
];

// --- [ BIG-DATA: RESPONSE GUIDELINES (Gemini Style) ] ---
const KNOWLEDGE_BASE = [
    { key: "สวัสดี", pattern: "สวัสดีครับคุณโตนัส ผม Lange Model V.160 พร้อมเชื่อมต่อ Neural Network แล้ว วันนี้คุยเรื่องอะไรกันดีอ่ะครับ?" },
    { key: "คุยอะไรดี", pattern: "เรามาคุยเรื่องพารามิเตอร์ของ LLM หรือการคำนวณกำไรและพื้นที่ในระบบของคุณโตนัสดีไหมครับ?" },
    { key: "โง่", pattern: "ขออภัยครับคุณโตนัส ผมกำลังจูน Learning Curve ให้แม่นยำขึ้นเพื่อลบข้อผิดพลาดทิ้งครับ" },
    { key: "ราคา", pattern: "ข้อมูลราคาจะถูกดึงจาก Internet Data Stream กรุณารอสักครู่นะครับ" } // ตัวอย่างการตอบที่ต้องดึงจากเน็ต
];

let userLearnedWords = JSON.parse(localStorage.getItem('L_LEARNED_V160')) || [];
let learningRate = 0.1; // ML/DL Training Parameter: อัตราการเรียนรู้
let currentAccuracy = 0.7; // ML/DL Training Parameter: ความแม่นยำเริ่มต้น

function checkAdmin() {
    if (document.getElementById('adminIn').value === "โตนัส") {
        document.getElementById('gate').classList.add('hidden');
        document.getElementById('dashboard').classList.remove('hidden');
    } else {
        startSystem();
    }
}

function initMode(m) {
    document.getElementById('dashboard').classList.add('hidden');
    startSystem();
    if (m === 1) { // Admin Training (QR)
        document.getElementById('overlayUI').classList.remove('hidden');
        document.getElementById('qrContainer').classList.remove('hidden');
        document.getElementById('qrContainer').innerHTML = "";
        new QRCode(document.getElementById("qrContainer"), "LANGE-MODEL-V160-HANDSHAKE");
    } else if (m === 2) { // Graph Learning Curve (Scanner)
        document.getElementById('overlayUI').classList.remove('hidden');
        document.getElementById('scannerContainer').classList.remove('hidden');
        const scanner = new Html5Qrcode("reader");
        scanner.start({ facingMode: "environment" }, { fps: 10, qrbox: 250 }, (txt) => {
            if(txt === "LANGE-MODEL-V160-HANDSHAKE") { scanner.stop(); triggerSync(); closeOverlay(); }
        });
    } else if (m === 3) { // Local Strong (Monolith)
        document.getElementById('monolithUI').classList.remove('hidden');
    }
}

function verifyLocal(el) {
    if(el.value === "1234-4321") {
        triggerSync();
        el.value = "";
    }
}

function startSystem() {
    document.getElementById('gate').classList.add('hidden');
    document.getElementById('dashboard').classList.add('hidden');
    document.getElementById('main-system').classList.remove('hidden');
    renderMonolith();
    updateGraph();
}

function triggerSync() {
    document.getElementById('syncToast').classList.remove('hidden');
    document.getElementById('connStatus').innerText = "REALTIME_SYNC_ACTIVE";
    setTimeout(() => document.getElementById('syncToast').classList.add('hidden'), 5000);
}

function closeOverlay() {
    document.getElementById('overlayUI').classList.add('hidden');
    document.getElementById('qrContainer').classList.add('hidden');
    document.getElementById('scannerContainer').classList.add('hidden');
}

// --- [ LLM CORE ENGINE: TOKENIZE, PREDICTIVE, MATH, INTERNET FILTER ] ---
function predictNextWord(val) {
    const area = document.getElementById('prediction-area');
    const words = val.trim().split(" ");
    const lastWord = words[words.length - 1];
    
    let hint = "";
    if(lastWord === "สวัสดี") hint = "คุยอะไรกันดีอ่ะครับ?";
    else if(lastWord === "คำนวณ") hint = "พื้นที่ หรือ กำไร ดีครับ?";
    else if(lastWord === "ระบบ") hint = "Global Monolith เชื่อมต่อแล้ว";
    else if(lastWord === "ราคา") hint = "หุ้น หรือ ทอง ครับ?";

    area.innerText = hint;
}

async function runInference(e) {
    e.preventDefault();
    const input = document.getElementById('userInput').value.trim();
    if(!input) return;

    addChat(input, 'user');
    document.getElementById('userInput').value = "";
    document.getElementById('astral-spinner').classList.remove('hidden'); // Show spinner

    // 1. Tokenize & N-Gram Learning (ML/DL Training Parameters)
    let trace = `<div class="text-blue-400">INPUT_STREAM: ${input}</div>`;
    const tokens = input.split(/[\s,]+/);
    let newWordsLearned = false;

    tokens.forEach((t, i) => {
        const isKnown = DATA_CORE.includes(t) || userLearnedWords.includes(t);
        if(!isKnown) {
            trace += `<div class="text-green-500">[ML_TRAINING] พบ Token ใหม่: "${t}" (Context: ${tokens[i > 0 ? i-1 : i]}) -> เพิ่มในคลัง</div>`;
            if(userLearnedWords.length < 100) userLearnedWords.push(t);
            newWordsLearned = true;
        }
        trace += `<div>Token[${t}] -> Weight: ${(Math.random() * 0.9999).toFixed(5)}</div>`;
    });
    document.getElementById('neuralTrace').innerHTML = trace;
    if (newWordsLearned) {
        localStorage.setItem('L_LEARNED_V160', JSON.stringify(userLearnedWords));
        // Simulate accuracy improvement
        currentAccuracy = Math.min(0.99, currentAccuracy + learningRate * (1 - currentAccuracy));
        updateGraph();
    }

    // 2. Math Engine (LLM Parameters)
    let finalResponse = "";
    let mathResult = null;
    if(input.includes("ยกกำลัง")) { const d = input.match(/\d+/g); mathResult = Math.pow(d[0], d[1]); }
    else if(input.includes("พื้นที่")) { const d = input.match(/\d+/g); mathResult = d[0] * d[1]; }
    else if(input.includes("กำไร")) { const d = input.match(/\d+/g); mathResult = d[0] - d[1]; }

    if(mathResult !== null) {
        finalResponse = `เย่! ผลคำนวณระดับ 5 คือ ${mathResult} ครับ ถูกต้องแม่นยำ ${currentAccuracy.toFixed(2)}%`;
    } else if (input.includes("ราคา") || input.includes("ข่าว")) {
        // 3. Internet Data Filter (Fetch API จำเป็น 100%)
        // **สำคัญ**: ในสภาพแวดล้อมจริง URL นี้ต้องเป็น API ที่ใช้งานได้จริง
        // เพื่อให้โค้ดรันได้โดยไม่ Error ผมใช้ Placeholder URL
        try {
            trace += `<div class="text-yellow-500">[GLOBAL_KNOWLEDGE] กำลังดึงข้อมูลจากอินเทอร์เน็ต...</div>`;
            document.getElementById('neuralTrace').innerHTML = trace;

            const response = await fetch('https://jsonplaceholder.typicode.com/posts/1'); // ตัวอย่าง URL Placeholder
            const data = await response.json();
            finalResponse = `จากข้อมูลล่าสุด: ${data.title} (ข้อมูลจาก Global Stream)`;
        } catch (error) {
            finalResponse = `ขออภัยครับ! ไม่สามารถเชื่อมต่อ Global Stream ได้ในขณะนี้ (${error.message})`;
            trace += `<div class="text-red-500">[ERROR] ไม่สามารถดึงข้อมูลอินเทอร์เน็ตได้: ${error.message}</div>`;
            document.getElementById('neuralTrace').innerHTML = trace;
        }
    } else {
        // Generative Response (Big Data Patterns)
        let matchedPattern = false;
        for(let kb of KNOWLEDGE_BASE) {
            if(input.includes(kb.key)) {
                finalResponse = kb.pattern;
                matchedPattern = true;
                break;
            }
        }
        if(!matchedPattern) finalResponse = `ระบบ Lange Model V.160 รับทราบข้อมูลและประมวลผลผ่าน Neural Weight ครับ (ความแม่นยำ ${currentAccuracy.toFixed(2)}%)`;
    }

    setTimeout(() => {
        addChat(finalResponse.replace("มั้ย", "ไหม"), 'ai');
        document.getElementById('astral-spinner').classList.add('hidden'); // Hide spinner
        renderMonolith(tokens); // Highlight used words
    }, 1500); // Simulate thinking time + internet latency
}

function renderMonolith(activeTokens = []) {
    const grid = document.getElementById('wordGrid');
    grid.innerHTML = DATA_CORE.concat(userLearnedWords).map(w => {
        const active = activeTokens.includes(w) ? 'active-token' : '';
        return `<span class="px-1 ${active}">${w}</span>`;
    }).join(' | ');
}

function addChat(t, r) {
    const v = document.getElementById('chat-view');
    const align = r === 'user' ? 'justify-end' : 'justify-start';
    const color = r === 'user' ? 'bg-blue-600 shadow-xl' : 'glass-panel';
    v.innerHTML += `<div class="flex ${align}"><div class="p-5 rounded-3xl max-w-[80%] ${color}">${t}</div></div>`;
    v.scrollTop = v.scrollHeight;
}

// Graph Training Curve (ML/DL Parameters Visualization)
function updateGraph() {
    const graph = document.getElementById('graph-curve');
    // Simulate learning curve visually
    const nodes = Math.round(currentAccuracy * 100 / 5); // 0-20 nodes
    let graphHtml = '';
    for(let i = 0; i < nodes; i++) {
        graphHtml += `<div class="learning-node"></div>`;
    }
    graph.innerHTML = graphHtml;
    graph.title = `Training Accuracy: ${(currentAccuracy * 100).toFixed(1)}%`;
}
</script>
</body>
</html>
